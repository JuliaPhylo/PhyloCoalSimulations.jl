<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>internals · PhyloCoalSimulations.jl</title><meta name="title" content="internals · PhyloCoalSimulations.jl"/><meta property="og:title" content="internals · PhyloCoalSimulations.jl"/><meta property="twitter:title" content="internals · PhyloCoalSimulations.jl"/><meta name="description" content="Documentation for PhyloCoalSimulations.jl."/><meta property="og:description" content="Documentation for PhyloCoalSimulations.jl."/><meta property="twitter:description" content="Documentation for PhyloCoalSimulations.jl."/><meta property="og:url" content="https://cecileane.github.io/PhyloCoalSimulations.jl/stable/lib/internal/"/><meta property="twitter:url" content="https://cecileane.github.io/PhyloCoalSimulations.jl/stable/lib/internal/"/><link rel="canonical" href="https://cecileane.github.io/PhyloCoalSimulations.jl/stable/lib/internal/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PhyloCoalSimulations.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">home</a></li><li><span class="tocitem">manual</span><ul><li><a class="tocitem" href="../../man/getting_started/">getting started</a></li><li><a class="tocitem" href="../../man/mapping_genetree_to_network/">mapping gene trees into the species network</a></li><li><a class="tocitem" href="../../man/converting_coal2generation_units/">converting between units</a></li><li><a class="tocitem" href="../../man/correlated_inheritance/">correlated inheritance</a></li><li><a class="tocitem" href="../../man/more_examples/">more examples</a></li></ul></li><li><span class="tocitem">library</span><ul><li><a class="tocitem" href="../public/">public</a></li><li class="is-active"><a class="tocitem" href>internals</a><ul class="internal"><li><a class="tocitem" href="#functions-and-types"><span>functions &amp; types</span></a></li><li><a class="tocitem" href="#index"><span>index</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">library</a></li><li class="is-active"><a href>internals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>internals</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cecileane/PhyloCoalSimulations.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/cecileane/PhyloCoalSimulations.jl/blob/main/docs/src/lib/internal.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="internal-documentation"><a class="docs-heading-anchor" href="#internal-documentation">internal documentation</a><a id="internal-documentation-1"></a><a class="docs-heading-anchor-permalink" href="#internal-documentation" title="Permalink"></a></h1><p>Documentation for <code>PhyloCoalSimulations</code>&#39;s internal functions. These functions are not exported and their access (API) should not be considered stable. But they can still be used, like this for example: <code>PhyloCoalSimulations.foo()</code> for a function named <code>foo()</code>.</p><h2 id="functions-and-types"><a class="docs-heading-anchor" href="#functions-and-types">functions &amp; types</a><a id="functions-and-types-1"></a><a class="docs-heading-anchor-permalink" href="#functions-and-types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PhyloCoalSimulations.mappingnodes" href="#PhyloCoalSimulations.mappingnodes"><code>PhyloCoalSimulations.mappingnodes</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mappingnodes(gene tree)</code></pre><p>Type to define an iterator over degree-2 mapping nodes in a gene tree, assuming these degree-2 nodes (other than the root) have a name to map them to nodes in a species phylogeny. See <a href="#PhyloCoalSimulations.mappingnodes"><code>ismappingnode</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cecileane/PhyloCoalSimulations.jl/blob/013881e3c5a29ccc52b92013801da0ad0f435276/src/utils.jl#L19-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PhyloCoalSimulations.coalescence_edge-NTuple{4, Any}" href="#PhyloCoalSimulations.coalescence_edge-NTuple{4, Any}"><code>PhyloCoalSimulations.coalescence_edge</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">coalescence_edge(edge1, edge2, number, populationid)</code></pre><p>Create a coalescence between edges 1 and 2: with a new parent node <code>n</code> numbered <code>number</code> and a new parent edge <code>e</code> above the parent node, of length 0 and numbered <code>number</code>. Both <code>n.inCycle</code> and <code>e.inCycle</code> are set to <code>populationid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cecileane/PhyloCoalSimulations.jl/blob/013881e3c5a29ccc52b92013801da0ad0f435276/src/simulatecoalescent_onepop.jl#L95-L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PhyloCoalSimulations.convert2tree!-Tuple{PhyloNetworks.Node}" href="#PhyloCoalSimulations.convert2tree!-Tuple{PhyloNetworks.Node}"><code>PhyloCoalSimulations.convert2tree!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">convert2tree!(rootnode)</code></pre><p>Return a network with all nodes and edges that can be reached from <code>rootnode</code>. <strong>Warning</strong>: Assumes that edges are correctly directed (with correct <code>isChild1</code> attribute) and that the graph is a tree. This is <em>not</em> checked.</p><p>If the root node is still attached to an incomplete root edge, this edge &amp; node are first disconnected.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cecileane/PhyloCoalSimulations.jl/blob/013881e3c5a29ccc52b92013801da0ad0f435276/src/simulatecoalescent_onepop.jl#L249-L258">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PhyloCoalSimulations.get_rootedgenumber-Tuple{Any}" href="#PhyloCoalSimulations.get_rootedgenumber-Tuple{Any}"><code>PhyloCoalSimulations.get_rootedgenumber</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_rootedgenumber(network)</code></pre><p>1 + maximum of 0 and of all the network&#39;s edge numbers: can be used as a unique identifier of the edge above the network&#39;s root.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cecileane/PhyloCoalSimulations.jl/blob/013881e3c5a29ccc52b92013801da0ad0f435276/src/simulatecoalescent_network.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PhyloCoalSimulations.initializetip" href="#PhyloCoalSimulations.initializetip"><code>PhyloCoalSimulations.initializetip</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">initializetip(species::AbstractString, individual::AbstractString,
              number::Integer, delim=&quot;&quot;::AbstractString)</code></pre><p>Create a leaf node and a pendant edge of length 0, incident to each other, both numbered <code>number</code>. Return the pendant edge. The leaf name is made by concatenating <code>species</code>, <code>delim</code> and <code>individual</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cecileane/PhyloCoalSimulations.jl/blob/013881e3c5a29ccc52b92013801da0ad0f435276/src/simulatecoalescent_onepop.jl#L119-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PhyloCoalSimulations.initializetipforest" href="#PhyloCoalSimulations.initializetipforest"><code>PhyloCoalSimulations.initializetipforest</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">initializetipforest(speciesnode::Node, nindividuals::Integer,
              number::Integer, delim)</code></pre><p>Vector of pendant leaf edges, with leaves named after <code>speciesnode</code>, and numbered with consecutive number IDs starting at <code>number</code>. If nindividuals is 1, then the leaf name is simply the species name. Otherwise, then the leaf names include the individual number and the default delimiter is <code>_</code>. For example, if the species name is <code>s</code> then leaf names are: <code>s_1</code>, <code>s_2</code>, etc. by default.  Pendant leaf edges have inCycle set to the number of the corresponding edge in the species network.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cecileane/PhyloCoalSimulations.jl/blob/013881e3c5a29ccc52b92013801da0ad0f435276/src/simulatecoalescent_onepop.jl#L142-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PhyloCoalSimulations.ismappingnode-Tuple{PhyloNetworks.Node}" href="#PhyloCoalSimulations.ismappingnode-Tuple{PhyloNetworks.Node}"><code>PhyloCoalSimulations.ismappingnode</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ismappingnode(node)</code></pre><p>Boolean: true if <code>node</code> is of degree 2, has a single child, and has a name. (The root is of degree-2 but is not a mapping node).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cecileane/PhyloCoalSimulations.jl/blob/013881e3c5a29ccc52b92013801da0ad0f435276/src/utils.jl#L11-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PhyloCoalSimulations.map2population!-NTuple{4, Any}" href="#PhyloCoalSimulations.map2population!-NTuple{4, Any}"><code>PhyloCoalSimulations.map2population!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">map2population!(forest, population_node, populationid, nextlineageID)</code></pre><p>Extend each incomplete edge in the forest with a new degree-2 node <code>n</code> and a new incomplete edge <code>e</code>, with the following information to map <code>n</code> and <code>e</code> into the species phylogeny:</p><ul><li><code>e.inCycle</code> is set to <code>populationid</code>, and</li><li><code>n.name</code> is set to <code>population_node.name</code> if this name is non-empty, or <code>string(population_node.number)</code> otherwise (with any negative sign replaced by the string &quot;minus&quot;).</li></ul><p><code>e.number</code> and <code>n.number</code> are set to <code>nextlineageID</code>, which is incremented by 1 for each incomplete edge in the forest.</p><p>The forest is updated to contain the newly-created incomplete edges, replacing the old incomplete (and now complete) edges.</p><p>Output: nextlineageID, incremented by the number of newly created degree-2 lineages.</p><p><strong>example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using PhyloNetworks; net = readTopology(&quot;(A:1,B:1);&quot;);

julia&gt; leafA = net.node[1]; edge2A_number = net.edge[1].number;

julia&gt; f = PhyloCoalSimulations.initializetipforest(leafA, 2, 4); # 2 edges, numbered 4 &amp; 5

julia&gt; PhyloCoalSimulations.map2population!(f, leafA, edge2A_number, 6)
8

julia&gt; length(f)
2

julia&gt; f[2]
PhyloNetworks.EdgeT{PhyloNetworks.Node}:
 number:7
 length:0.0
 attached to 1 node(s) (parent first): 7

julia&gt; [e.node[1].name for e in f]
2-element Vector{String}:
 &quot;A&quot;
 &quot;A&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cecileane/PhyloCoalSimulations.jl/blob/013881e3c5a29ccc52b92013801da0ad0f435276/src/simulatecoalescent_onepop.jl#L173-L217">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PhyloCoalSimulations.population_mappedto-Tuple{Union{PhyloNetworks.EdgeT{PhyloNetworks.Node}, PhyloNetworks.Node}}" href="#PhyloCoalSimulations.population_mappedto-Tuple{Union{PhyloNetworks.EdgeT{PhyloNetworks.Node}, PhyloNetworks.Node}}"><code>PhyloCoalSimulations.population_mappedto</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">population_mappedto(edge or node)</code></pre><p>Identifier of the population (edge in the species network) that a gene tree&#39;s edge or a node is mapped onto, or <code>nothing</code> if not mapped. For example, coalescent nodes in gene trees map to a <em>node</em> in the species phylogeny, instead of mapping to an <em>edge</em>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cecileane/PhyloCoalSimulations.jl/blob/013881e3c5a29ccc52b92013801da0ad0f435276/src/utils.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PhyloCoalSimulations.simulatecoal_onepopulation!-Tuple{AbstractVector, Vararg{Any}}" href="#PhyloCoalSimulations.simulatecoal_onepopulation!-Tuple{AbstractVector, Vararg{Any}}"><code>PhyloCoalSimulations.simulatecoal_onepopulation!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">simulatecoal_onepopulation!([rng::AbstractRNG,]
    lineagelist,
    population_length,
    nextlineageID,
    populationID=-1
)</code></pre><p>Simulate the coalescent process within a single population of length given in coalescent units, starting from lineages in <code>lineagelist</code>. This list should be a vector of incomplete edges, that is, edges incident to a single node only.</p><p>Vector of incomplete edges, whose lengths have been increased, is modified in place. New nodes and their parent edges are created by coalescent events, numbered with consecutive integers starting at <code>nextlineageID</code>.</p><p>The random number generator <code>rng</code> is optional.</p><p>Output: nextlineageID, incremented by number of new lineages.</p><p>In lineages, edge lengths are also considered in coalescent units.</p><p>The newly created nodes and edges have their <code>.inCycle</code> attribute set to <code>populationID</code>, so as to track the mapping of gene lineages to populations in the species phylogeny.</p><p><strong>examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; PhyloCoalSimulations.simulatecoal_onepopulation!([], 2.0, 1)
1

julia&gt; e1 = PhyloCoalSimulations.initializetip(&quot;s&quot;,&quot;1&quot;,1,&quot;&quot;);

julia&gt; e2 = PhyloCoalSimulations.initializetip(&quot;s&quot;,&quot;2&quot;,2,&quot;&quot;);

julia&gt; forest = [e1,e2];

julia&gt; using Random; Random.seed!(7690);

julia&gt; PhyloCoalSimulations.simulatecoal_onepopulation!(forest, Inf, 3);

julia&gt; PhyloCoalSimulations.convert2tree!(forest[1].node[1])
PhyloNetworks.HybridNetwork, Rooted Network
2 edges
3 nodes: 2 tips, 0 hybrid nodes, 1 internal tree nodes.
tip labels: s2, s1
(s2:0.302,s1:0.302);
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cecileane/PhyloCoalSimulations.jl/blob/013881e3c5a29ccc52b92013801da0ad0f435276/src/simulatecoalescent_onepop.jl#L1-L51">source</a></section></article><h2 id="index"><a class="docs-heading-anchor" href="#index">index</a><a id="index-1"></a><a class="docs-heading-anchor-permalink" href="#index" title="Permalink"></a></h2><ul><li><a href="#PhyloCoalSimulations.mappingnodes"><code>PhyloCoalSimulations.mappingnodes</code></a></li><li><a href="#PhyloCoalSimulations.coalescence_edge-NTuple{4, Any}"><code>PhyloCoalSimulations.coalescence_edge</code></a></li><li><a href="#PhyloCoalSimulations.convert2tree!-Tuple{PhyloNetworks.Node}"><code>PhyloCoalSimulations.convert2tree!</code></a></li><li><a href="#PhyloCoalSimulations.get_rootedgenumber-Tuple{Any}"><code>PhyloCoalSimulations.get_rootedgenumber</code></a></li><li><a href="#PhyloCoalSimulations.initializetip"><code>PhyloCoalSimulations.initializetip</code></a></li><li><a href="#PhyloCoalSimulations.initializetipforest"><code>PhyloCoalSimulations.initializetipforest</code></a></li><li><a href="#PhyloCoalSimulations.ismappingnode-Tuple{PhyloNetworks.Node}"><code>PhyloCoalSimulations.ismappingnode</code></a></li><li><a href="#PhyloCoalSimulations.map2population!-NTuple{4, Any}"><code>PhyloCoalSimulations.map2population!</code></a></li><li><a href="#PhyloCoalSimulations.population_mappedto-Tuple{Union{PhyloNetworks.EdgeT{PhyloNetworks.Node}, PhyloNetworks.Node}}"><code>PhyloCoalSimulations.population_mappedto</code></a></li><li><a href="#PhyloCoalSimulations.simulatecoal_onepopulation!-Tuple{AbstractVector, Vararg{Any}}"><code>PhyloCoalSimulations.simulatecoal_onepopulation!</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../public/">« public</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Friday 17 May 2024 13:35">Friday 17 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
